# open evcc at http://evcc.local:7070
database:
    type: sqlite
    dsn: /var/lib/evcc/evcc.db

network:
  schema: http
  host: evcc.local # .local suffix announces the hostname on MDNS
  port: 7070

log: debug
levels:
  cache: error

# unique installation id
plant: 69ec375c4a8abc1fd130de5e968896c9ae01a9efe8cf33af0e640b761723f24d

interval: 30s # control cycle interval

  #vehicles:
  #  - name: BYD
  #  title: blauer ATTO 3
  #  type: template
  #  template: offline
  #  capacity:  60 # in kWh
  #- name: BMW
  #  title: blauer iX
  #  type: template
  #  template: offline
  #  capacity:  65 # in kWh

meters:
- type: template
  template: huawei-dongle-powersensor 
  id: 1  
  host: 192.168.178.181  
  port: 502  
  usage: grid  
  storageunit: 1  
  modbus: tcpip  
  timeout: 15s  
  name: grid1

- type: template
  template: hoymiles-ahoydtu
  usage: pv
    #host: 192.168.178.188 # IP-Adresse oder Hostname 
  host: xdbu92gos1irkzbd.myfritz.net:8032
  name: mini600

- type: template
  template: hoymiles-opendtu
  usage: pv
  host: 192.168.178.104 # IP-Adresse oder Hostname 
  name: mini800

- type: template
  template: huawei-dongle-powersensor 
  id: 1  
  host: 192.168.178.181  
  port: 502  
  usage: pv  
  storageunit: 1  
  modbus: tcpip  
  timeout: 15s  
  name: pv2

- type: template
  template: huawei-dongle-powersensor 
  id: 1  
  host: 192.168.178.181  
  port: 502  
  usage: battery  
  storageunit: 1  
  modbus: tcpip  
  timeout: 15s  
  name: battery3
  maxchargepower: 5000

- name: eastron_via_mqtt
  type: custom
  power:
    source: mqtt
    broker: 192.168.178.85:1883
    topic: readmod/sdm54/power 
  
- name: sdm54
  type: template
  template: eastron-sdm120
  usage: ext
  modbus: tcpip
  id: 1
  host: 192.168.178.131
  port: 502
  
- name: kdk
  type: template
  template: inepro
  usage: ext
  modbus: tcpip
  id: 1
  host: 192.168.178.131
  port: 502
  
    #chargers:
    #- type: template
    #  template: elliconnect 
    # EVCC SKI: 7BF7 CA32 30B5 B314 F553 6E82 662D 504E 0CB6 8B48
    #  ski: 31A9 C90F 3099 EB76 FA79 23AA F8BA 0F88 61EC EF98
    ## old:   ski: 869E 2E68 A0AC AE70 0340 ABCC 3B8C F6F4 2DCF 0C41
    #  ip: 192.168.178.108  
    ##ip: 192.168.178.110
    #  name: wallbox4

    #- type: template
    #  template: em2go-home
    #  host: 192.168.178.143  
    #  name: wallbox1

    #loadpoints:
  #- title: Garage
  #vehicle: BYD
  # charger: wallbox4
  # mode: off

    #- title: Garage1
    #  vehicle: BYD
    #  charger: wallbox1
    #  mode: off

site:
  title: HOME
    #  residualPower: 0
  meters:
    grid: grid1
    pv:
    - pv2
      #- mini800 ## relying on opendtu which fails at times 
      #use mqtt from readmod instead:
    - eastron_via_mqtt
    battery:
    - battery3
    ext:
      - kdk
        #- eastron_via_mqtt
      #- sdm54
      #- mini600

# mqtt message broker
mqtt:
  broker: localhost:1883
  topic: evcc # root topic for publishing, set empty to disable publishing
  # clientid: foo
  # user:
  # password:

eebus:
  certificate:
      private: |
          -----BEGIN EC PRIVATE KEY-----
          MHcCAQEEIArnKuTE/jHlbzBYgLt9oLY9Muw05ABcahMOEtx3RovwoAoGCCqGSM49
          AwEHoUQDQgAELRvssShoFMQtKYfrSAhrBKAsarmDEc4tsarT1+16+NVMfkvuUR8/
          auWw32YIThsQWo1dWhJG26/lYXQ9g1U/Cw==
          -----END EC PRIVATE KEY-----
      public: |
          -----BEGIN CERTIFICATE-----
          MIIBvTCCAWOgAwIBAgIRAesvrROlAVLO+EGZLusHKEQwCgYIKoZIzj0EAwIwPjEL
          MAkGA1UEBhMCREUxDTALBgNVBAoTBEVWQ0MxCTAHBgNVBAsTADEVMBMGA1UEAwwM
          RVZDQ19IRU1TXzAxMB4XDTI0MDQxNDEwMDIxOVoXDTM0MDQxMjEwMDIxOVowPjEL
          MAkGA1UEBhMCREUxDTALBgNVBAoTBEVWQ0MxCTAHBgNVBAsTADEVMBMGA1UEAwwM
          RVZDQ19IRU1TXzAxMFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAELRvssShoFMQt
          KYfrSAhrBKAsarmDEc4tsarT1+16+NVMfkvuUR8/auWw32YIThsQWo1dWhJG26/l
          YXQ9g1U/C6NCMEAwDgYDVR0PAQH/BAQDAgeAMA8GA1UdEwEB/wQFMAMBAf8wHQYD
          VR0OBBYEFHv3yjIwtbMU9VNugmYtUE4MtotIMAoGCCqGSM49BAMCA0gAMEUCIGY+
          Q8Sn2B5WkFoLy9kBCjxr0osvVc5OwBfUkW6tVMLtAiEAw5WV53mvkzUCMFjM/E/n
          C/qGXpZYA+fYpptE3rO1yYQ=
          -----END CERTIFICATE-----
